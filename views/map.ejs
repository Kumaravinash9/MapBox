<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <script src="https://kit.fontawesome.com/5a891aa92f.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">  
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css' rel='stylesheet' />
    <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&display=swap" rel="stylesheet">
   
     </head>
<style>
    *{
    margin: 0px;
    padding: 0px;
    box-sizing: border-box;
  }
 
 body
 {
     width: 100vw;
     height: 100vh;
 }

 #map

 {
     width: 100%;
     height: 100%;
     position: absolute;

  }

 input
 {
     width: 100%;
     min-width: 200px;
     font-size: .8rem;
     font-style: italic;
     height: 8vh;
     max-height: 50px;
     min-height: 30px;
     z-index: 2;
     cursor: pointer;
 }


.search
  {
 
  padding-left:24vw;
  
  padding-top: 20px;
  position: relative;
  width: 80vw;
  height:10vh;
  min-height: 20px;
  
  }

  input:hover
  {
    
  outline-style: solid;
  outline-color: rgb(103, 170, 233);
 border-color: rgb(103, 170, 233);
  }

#input-search
 {cursor: pointer;
  float: left;
  position: absolute;
  font-size: 1.2rem;
  color: black;
  
  padding-left: 10px;
  padding-top: 21px;
 }
 nav{
    background: black;
     color: white;
     font-family: "Bree Serif";
   
    
}
.nav-link{
    font-size: 1.05rem;
    color: white;
    font-family: "Lobster";
    
}
.nav-link:hover{
    cursor: pointer;
    color: inherit;
}
.navbar-brand{
    cursor: pointer;
}

.fas{
    font-size: 1.8rem;
    color: wheat
}
#direction{
    font-size: 1.2rem;
}
 @media screen  and (max-width: 600px){
     .search{
        padding-left:20vw ;
     }
     input{
         font-size: .6rem;
     }
     .nav-link{
         font-size: .8rem ;
     }
     #direction{
    font-size: .8rem;
}
.navbar-brand{
    font-size: 1rem;
}
.fas{
    font-size: 1.4rem;
    color: wheat
}
     
 }
 
</style>
     <body>
        <nav class="navbar navbar-expand justify-content-between  align-items-center">
            <a class="navbar-brand ml-2"><i class="fas fa-map-marker-alt mr-1"></i>BOX</a>
            <ul class="navbar-nav">
                <li class="nav-item mr-4"><a href="/navigator" class="nav-link">Navigate<i class="fas fa-directions mx-2"id="direction"></i></a></li>
            </ul>
        </nav>
    
     <div id='map' >

     </div>
    
     <div class="search"><i class="fas fa-search ml-2 "" id="input-search"  ></i> <input text="search" name="address" class="border rounded pl-5 mt-1" placeholder="put the location  where you wanna go" >
     </div>






   


     <script src='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js'></script>
    <script>
         mapboxgl.accessToken = 'pk.eyJ1IjoiZXJyb3I0MDciLCJhIjoiY2tjdHp3cGM5MjNzOTJybGhxa2F4OGwweCJ9.p2-LXrmjQGsXYT0jyIpx7g';
     var map = new mapboxgl.Map({
     container: 'map',
     center:[77.2090,28.6139],
     style: 'mapbox://styles/mapbox/streets-v11', 
     zoom: 8,
     });
     var markers = new mapboxgl.Marker().setLngLat([77.2090,28.6139]).setPopup(new mapboxgl.Popup().setHTML("<p>New Delhi</p>")).addTo(map);
     var currentlocation;
     if('geolocation'in navigator){
     navigator.geolocation.getCurrentPosition(async position  => {
     console.log(position);
      currentlocation = await position.coords;
     var marker = new mapboxgl.Marker().setLngLat([77.2090,28.6139]).addTo(map);
     marker.remove();
     marker=new mapboxgl.Marker().setLngLat([currentlocation.longitude,currentlocation.latitude]).addTo(map);
     map.on('load',function(){
     map.flyTo({
     center: [currentlocation.longitude ,currentlocation.latitude],zoom:8,
     essential: true 
     });})})}
    else
    {
    alert("permit the location for getting ur own location!");
    }



    async function postData(url = '', data = {}) {
    const response = await fetch(url, {
    method: 'POST', 
    mode: 'cors', 
    cache: 'no-cache', 
    credentials: 'same-origin', 
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
    });
    return  await response.json();
    }



     document.querySelector("input").addEventListener("input",function(e){
     this.addEventListener("keypress",function(e){
     if(e.code==="Enter"||e.code==="Tab")
{    var values=this.value;
     this.value=" ";
     postData("https://desolate-temple-27342.herokuapp.com/", { address:values})
    .then(data => {
        if(data.latlngdata[0].latitude!=39.390897)
       
     {console.log(data.latlngdata[0].latitude); 
        var start = [currentlocation.longitude,currentlocation.latitude];
      var end = [data.latlngdata[0].longitude,data.latlngdata[0].latitude];
        markers.remove();
     markers = new mapboxgl.Marker().setLngLat([data.latlngdata[0].longitude,data.latlngdata[0].latitude]).setPopup(new mapboxgl.Popup().setHTML("<p>"+data.latlngdata[0].city+"</p>")).addTo(map);
     var isAtStart = true;
     var target = isAtStart ? end : start;
      isAtStart = !isAtStart; 
     map.flyTo({
     center:[
     data.latlngdata[0].longitude,data.latlngdata[0].latitude],
     essential:true,
     speed: 1.2, 
    curve: 1, 
 
// This can be any easing function: it takes a number between
// 0 and 1 and returns another number between 0 and 1.
   easing: function(t) {
      return t;}
    
    
    }) }})
   }

}
    )});





var nav = new mapboxgl.NavigationControl();
map.addControl(nav, 'top-right');



    </script>




 
   
</body>
</html>